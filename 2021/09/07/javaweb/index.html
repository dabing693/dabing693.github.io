<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>javaweb教程 | 小辉博客</title><meta name="description" content="HTTP协议Http协议，即超文本传输协议，是用于从服务器到浏览器的传输协议。Http是一个基于tcp&#x2F;ip通信协议来传输数据（html文件、图片、查询结果等）的协议，是应用层的协议，http协议是对tcp协议的包装，其底层是tcp。 OSI模型与tcp&#x2F;ip模型     http工作原理 http协议工作于客户端（浏览器，httpclient） 浏览器作为http客户端通过url向http服务端"><meta name="author" content="dabing693"><meta name="copyright" content="dabing693"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2021/09/07/javaweb/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="javaweb教程"><meta property="og:url" content="http://yoursite.com/2021/09/07/javaweb/"><meta property="og:site_name" content="小辉博客"><meta property="og:description" content="HTTP协议Http协议，即超文本传输协议，是用于从服务器到浏览器的传输协议。Http是一个基于tcp&#x2F;ip通信协议来传输数据（html文件、图片、查询结果等）的协议，是应用层的协议，http协议是对tcp协议的包装，其底层是tcp。 OSI模型与tcp&#x2F;ip模型     http工作原理 http协议工作于客户端（浏览器，httpclient） 浏览器作为http客户端通过url向http服务端"><meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2021-09-07T13:51:08.247Z"><meta property="article:modified_time" content="2020-12-17T13:30:18.119Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="java高级" href="http://yoursite.com/2021/09/07/java%E9%AB%98%E7%BA%A7/"><link rel="next" title="Hexo发帖" href="http://yoursite.com/2021/09/07/Hexo_posts/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/flink.min.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="小辉博客" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://ae01.alicdn.com/kf/Hf828ff298f76464d9b00ad99cb873415F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HTTP协议"><span class="toc-number">1.</span> <span class="toc-text">HTTP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#http工作原理"><span class="toc-number">1.1.</span> <span class="toc-text">http工作原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http协议特点"><span class="toc-number">1.2.</span> <span class="toc-text">http协议特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP协议"><span class="toc-number">1.3.</span> <span class="toc-text">UDP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP协议"><span class="toc-number">1.4.</span> <span class="toc-text">TCP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7788"><span class="toc-number">1.5.</span> <span class="toc-text">7788</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Servlet"><span class="toc-number">2.</span> <span class="toc-text">Servlet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Servlet容器和servlet"><span class="toc-number">2.1.</span> <span class="toc-text">Servlet容器和servlet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编写servlet类"><span class="toc-number">2.2.</span> <span class="toc-text">编写servlet类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Servlet的工作机制"><span class="toc-number">2.3.</span> <span class="toc-text">Servlet的工作机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">2.4.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#P30-请求转发和重定向"><span class="toc-number">3.</span> <span class="toc-text">P30 请求转发和重定向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#请求转发"><span class="toc-number">3.1.</span> <span class="toc-text">请求转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重定向"><span class="toc-number">3.2.</span> <span class="toc-text">重定向</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#注解"><span class="toc-number">4.</span> <span class="toc-text">注解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#网页异步刷新技术Ajax"><span class="toc-number">5.</span> <span class="toc-text">网页异步刷新技术Ajax</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#其他"><span class="toc-number">6.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#jsp介绍"><span class="toc-number">7.</span> <span class="toc-text">jsp介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#会话技术–cookie工作原理"><span class="toc-number">8.</span> <span class="toc-text">会话技术–cookie工作原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#案例实战"><span class="toc-number">9.</span> <span class="toc-text">案例实战</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境搭建"><span class="toc-number">9.1.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#跳转到登录界面"><span class="toc-number">9.2.</span> <span class="toc-text">跳转到登录界面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#展示部门列表数据"><span class="toc-number">9.3.</span> <span class="toc-text">展示部门列表数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为系统增加登录认证"><span class="toc-number">9.4.</span> <span class="toc-text">为系统增加登录认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新增部门列表"><span class="toc-number">9.5.</span> <span class="toc-text">新增部门列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改部门"><span class="toc-number">9.6.</span> <span class="toc-text">修改部门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#保存修改"><span class="toc-number">9.7.</span> <span class="toc-text">保存修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据结构微调—uuid"><span class="toc-number">9.8.</span> <span class="toc-text">数据结构微调—uuid</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#保存部门"><span class="toc-number">9.9.</span> <span class="toc-text">保存部门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除部门"><span class="toc-number">9.10.</span> <span class="toc-text">删除部门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#javaweb过滤器filter"><span class="toc-number">9.11.</span> <span class="toc-text">javaweb过滤器filter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#统一认证权限"><span class="toc-number">9.12.</span> <span class="toc-text">统一认证权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码优化"><span class="toc-number">9.13.</span> <span class="toc-text">代码优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#引入jquery类库"><span class="toc-number">9.14.</span> <span class="toc-text">引入jquery类库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#服务器响应客户端json数据"><span class="toc-number">9.15.</span> <span class="toc-text">服务器响应客户端json数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#异步展示部门列表数据"><span class="toc-number">9.16.</span> <span class="toc-text">异步展示部门列表数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JavaWeb三层架构详解"><span class="toc-number">10.</span> <span class="toc-text">JavaWeb三层架构详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是三层架构？"><span class="toc-number">10.1.</span> <span class="toc-text">什么是三层架构？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#表示层（UI层）"><span class="toc-number">10.1.1.</span> <span class="toc-text">表示层（UI层）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#业务逻辑层（BLL层）"><span class="toc-number">10.1.2.</span> <span class="toc-text">业务逻辑层（BLL层）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据访问层（DAL层）"><span class="toc-number">10.1.3.</span> <span class="toc-text">数据访问层（DAL层）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么要用三层架构呢？"><span class="toc-number">10.2.</span> <span class="toc-text">为什么要用三层架构呢？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#表示层Model"><span class="toc-number">10.2.1.</span> <span class="toc-text">表示层Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#表示层Controller"><span class="toc-number">10.2.2.</span> <span class="toc-text">表示层Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#表示层View"><span class="toc-number">10.2.3.</span> <span class="toc-text">表示层View</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#持久层接口"><span class="toc-number">10.2.4.</span> <span class="toc-text">持久层接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#持久层实现类"><span class="toc-number">10.2.5.</span> <span class="toc-text">持久层实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#业务逻辑层接口"><span class="toc-number">10.2.6.</span> <span class="toc-text">业务逻辑层接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#业务逻辑层实现类"><span class="toc-number">10.2.7.</span> <span class="toc-text">业务逻辑层实现类</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">小辉博客</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">javaweb教程</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2021-09-07 21:51:08"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2021-09-07</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-12-17 21:30:18"><i class="fas fa-history fa-fw"></i> 更新于 2020-12-17</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/javaweb/">javaweb</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h1><p>Http协议，即超文本传输协议，是用于从服务器到浏览器的传输协议。Http是一个基于tcp/ip通信协议来传输数据（html文件、图片、查询结果等）的协议，是应用层的协议，http协议是对tcp协议的包装，其底层是tcp。</p>
<p>OSI模型与tcp/ip模型</p>
<p><img src= "/img/loading.gif" data-src="http://ww1.sinaimg.cn/large/ad3c4311gy1gll3sof0qjj207n05pwf8.jpg" alt="img"> </p>
<p><img src= "/img/loading.gif" data-src="http://ww1.sinaimg.cn/large/ad3c4311gy1gll3twl210j20cp02sgm1.jpg" alt="img"> </p>
<h2 id="http工作原理"><a href="#http工作原理" class="headerlink" title="http工作原理"></a>http工作原理</h2><ul>
<li>http协议工作于客户端（浏览器，httpclient）</li>
<li>浏览器作为http客户端通过url向http服务端即web服务器发布所有请求</li>
<li>Web服务器有：apache，nginx，tomcat等</li>
<li>Web服务器根据接收到的请求后，向客户端发送响应信息</li>
<li>服务器是基于http协议开发出来的，其底层通信用的是tcp</li>
</ul>
<h2 id="http协议特点"><a href="#http协议特点" class="headerlink" title="http协议特点"></a>http协议特点</h2><p>（1）无连接</p>
<p>无连接的含义是限制限制每次只处理一次请求，服务器处理完浏览器的请求，并收到客户的应答后，即断开连接。使用这种方式可以节约传输时间。</p>
<p>（2）无状态</p>
<p>无状态是指协议对于事务处理没有记忆能力。这意味这后续处理需要前面的信息，则必须重传。（利用会话技术去解决这一问题）。</p>
<h2 id="UDP协议"><a href="#UDP协议" class="headerlink" title="UDP协议"></a>UDP协议</h2><p>UDP是无连接通信协议，即在传输数据时，数据的发送端和接受端不建立逻辑连接。发送端不会确认接收端是否存在。收到数据时，接受端也不会向发送端反馈是否收到数据。</p>
<h2 id="TCP协议"><a href="#TCP协议" class="headerlink" title="TCP协议"></a>TCP协议</h2><p>​    Tcp协议是面向连接的通信协议，即在传输数据之前，在发送端和接受端建立逻辑连接，然后在传输数据，可以提供无差错可靠的数据传输。</p>
<p>​    在TCP协议中，在发送数据的准备阶段，客户端与服务器之间的三次交互，称为“==三次握手==”，以保证连接的可靠。</p>
<ol>
<li>客户端向服务器端发出连接请求，等待服务器确认。</li>
<li>服务器端向客户端回送一个响应，通知客户端收到了连接请求。</li>
<li>客户端再次向服务端发送确认信息，确认连接。</li>
</ol>
<h2 id="7788"><a href="#7788" class="headerlink" title="7788"></a>7788</h2><p>（1）网络编程三要素：协议、IP地址、端口号</p>
<p>​    IP地址可以唯一标识网络中的设备，端口号可以唯一标识设备中的进程（应用程序）</p>
<p>（2）URL和URI的区别</p>
<p>​    URL：统一资源定位符，uniform resource locator</p>
<p>​    <a href="http://28.89.78.189:8080/jspproject/index.jsp?data=as_data" target="_blank" rel="noopener">http://28.89.78.189:8080/jspproject/index.jsp?data=as_data</a></p>
<p>​    URI：http使用统一资源标识符（uri，uniform resource identifiers）来传输数据和建立连接。</p>
<p>​    /jspproject/index.jsp</p>
<p>（3）java工程</p>
<ul>
<li><p>都是java普通工程</p>
<ul>
<li>都有一个main方法</li>
</ul>
</li>
<li><p>javaweb工程</p>
<ul>
<li>main方法运行以后不会停止</li>
<li>java工程没有main方法</li>
<li>javaweb工程的main方法是在web容器（应用服务器Tomcat中）</li>
</ul>
</li>
</ul>
<p>（4） idea将javaweb工程打包成wer包</p>
<p>Javaweb发布的两种方式：文件夹的形式和打包成War包</p>
<h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><h2 id="Servlet容器和servlet"><a href="#Servlet容器和servlet" class="headerlink" title="Servlet容器和servlet"></a>Servlet容器和servlet</h2><p>Servlet容器，也称JavaWeb容器，或者Servlet/JSP容器，是为javaweb应用提供运行时环境，管理servlet和jsp的生命周期，以及管理它们的共享资源。目前流行的Servlet容器包括：Tomcat，Jetty，Weblogic，Jboss等。</p>
<p>Servlet：特别的java类</p>
<h2 id="编写servlet类"><a href="#编写servlet类" class="headerlink" title="编写servlet类"></a>编写servlet类</h2><ol>
<li>继承HttpServlet类</li>
<li>将servlet注册到tomcat服务器</li>
</ol>
<ul>
<li>通过url访问的请求，都是get请求</li>
<li>HttpServletRequest 接受客户端的请求的数据</li>
<li>HttpServletResponse 响应客户端的请求（向客户端响应内容）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class HelloServlet extends HttpServlet&#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void doGet(HtteServletRequest req,HttpServletResponse resp) throws ServletException,IOException&#123;</span><br><span class="line">    System.out.println(req.getParameter(&quot;name&quot;));</span><br><span class="line">    resp.getWriter().println(req.getParameter(&quot;name&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Servlet的工作机制"><a href="#Servlet的工作机制" class="headerlink" title="Servlet的工作机制"></a>Servlet的工作机制</h2><p>（1）Servlet的初始化和销毁</p>
<p>首次访问url地址，把类加载到虚拟机内存中，类加载完成后，又构造出对象。服务器检查servlet是否为第一次被请求。如果是第一次被请求，则：</p>
<ol>
<li>加载servlet类，加载HelloServlet.class到内存</li>
<li>实例化servlet类，调用HelloServlet的构造方法创建对象</li>
<li>调用init当法传递ServletConfig对象</li>
<li>调用service方法传递请求和响应对象</li>
</ol>
<p>如果不是第一次被请求，则：调用service方法传递请求和响应对象 。</p>
<p>（2）web容器处理servlet请求</p>
<ol>
<li>将请求与web.xml文件中的servlet进行映射</li>
<li>为请求创建请求和响应对象</li>
<li>调用线程上的service方法</li>
<li>公共service方法内部调用受保护的service方法</li>
<li>受保护的service方法根据请求的类型调用doGet或者doGet方法</li>
<li>doGet或者doPost方法生成响应，并将其传递给客户端</li>
<li>发送响应后，web容器将删除请求和响应对象</li>
</ol>
<p>（3）Servlet的生命周期</p>
<p>Web容器维护servlet的生命周期</p>
<p>Servlet的生命周期分为以下几步：</p>
<ol>
<li>加载servlet类</li>
<li>创建servlet类实例</li>
<li>调用servlet类的init方法</li>
<li>调用servlet类的service方法</li>
<li>调用servlet类的destory方法（tomcat重启或停机的时候会调用）</li>
</ol>
<p>（4）Servlet初始化的时机</p>
<ul>
<li>在首次访问servlet的时候，完成servlet类的加载和对象的创建，处理对应的请求</li>
<li>在没有请求到来前加载</li>
</ul>
<p>（5）http请求类型</p>
<ul>
<li>get：获取服务器数据</li>
<li>Post：发送给服务器数据</li>
<li>Put：更新服务器数据</li>
<li>Delete：删除服务器数据</li>
</ul>
<p>（6）Htttp常见状态码</p>
<ul>
<li>200：请求成功</li>
<li>301：资源被永久转移到其他url</li>
<li>404：请求的资源（网页等）不存在</li>
<li>405：请求的方法类型不支持</li>
<li>500：内部服务器错误</li>
</ul>
<p>（7）GET请求</p>
<p>特点：传送的数据是有限制的，一般限制在1kb以下。使用的地方：超链接，表单等。</p>
<p>（8）POST请求</p>
<p>特点：传送的数据量要比GET数据大得多</p>
<p>post请求方式主要用于向服务器端提交form表单的数据</p>
<p>Post方式将各个表单字段元素及其数据作为http消息的实体内容发送给web服务器</p>
<p>==Get请求的参数是在url地址中==</p>
<p>==Post请求的内容是在http消息的body中==</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Post发送请求数据的时候乱码</span></span><br><span class="line">req.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line"><span class="comment">//解决服务器响应数据乱码</span></span><br><span class="line">resp.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br></pre></td></tr></table></figure>



<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>Servlet容器：tomcat，jetty，jboss…</p>
<p>（1）写自己的httpservlet类</p>
<ul>
<li>继承HttpServlet类</li>
<li>配置web.xml文件</li>
</ul>
<p>（2）配置servlet：容器读取web.xml文件，注册web.xml中配置的servlet</p>
<p>（3）servlet初始化</p>
<ul>
<li>客户端首次访问servlet的时候完成初始化</li>
<li>在容器启动的时候就完成servlet初始化</li>
<li>将servlet字节码文件加载到虚拟机</li>
<li>调用servlet的构造方法创建对象</li>
<li>调用servlet的init方法完成初始化</li>
</ul>
<p>（4）servlet响应客户端请求</p>
<ul>
<li>首先调用用公共的方法：service(ServletRequest req,ServletResponse resq)</li>
<li>公共的service调用protected service(HttpServletRequest req,HttpServletResponse resq)</li>
<li>判断请求类型，根据不同的请求类型调用不同的方法：doGet 处理get请求，doPost 处理post请求。</li>
</ul>
<p>（5）调用doGet或者doPost方法处理客户端请求</p>
<p>HttpServletRequest：封装的客户端的请求信息</p>
<p>HttpServletResponse：封装服务器响应给客户端的信息</p>
<p>上面两个对象，再一次请求结束后销毁</p>
<p>（6）GET和POST的区别</p>
<p>Get请求包括，url和点击网页上的链接、提交表单的时候的method=”get”等。get请求的参数是加在url后面，只能发送少量的信息，发送给服务器的内容都是字符串。</p>
<p>Post请求包括，提交表单的时候的method=”post”、（可以提交更多的数据、文本、文件上传、登录注册）。post请求的数据是是在http请求报文的请求体中的。</p>
<p>（7）servlet的生命周期—-Servlet对象创建到销毁的过程</p>
<h1 id="P30-请求转发和重定向"><a href="#P30-请求转发和重定向" class="headerlink" title="P30 请求转发和重定向"></a>P30 请求转发和重定向</h1><h2 id="请求转发"><a href="#请求转发" class="headerlink" title="请求转发"></a>请求转发</h2><p>去银行办理业务c，a窗口办理好了，提交信息，把资料转给b窗口</p>
<p><img src= "/img/loading.gif" data-src="http://ww1.sinaimg.cn/large/ad3c4311gy1glno5do5i2j20a503wdfy.jpg" alt="img"> </p>
<p>请求转发可以转发到另一个servlet，jsp，html    </p>
<p>转发过程中需要携带上一次请求的信息到新的请求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//请求转发到另一个servlet</span></span><br><span class="line">request.getRequestDispatcher(<span class="string">"demo2"</span>).forward(request,response);</span><br><span class="line"></span><br><span class="line"><span class="comment">//请求转发到一个jsp视图界面</span></span><br><span class="line"><span class="comment">//setAttribute是请求转发的时候设置的，可以向下一个请求传递。参数是可以从从客户端设置的</span></span><br><span class="line">request.setAttribute(<span class="string">"age"</span>,<span class="string">"19"</span>);</span><br><span class="line">request.setAttribute(<span class="string">"sex"</span>,<span class="string">"boy"</span>);</span><br><span class="line">request.getRequestDispatcher(<span class="string">"demo2.jsp"</span>).forward(request,response);</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="http://ww1.sinaimg.cn/large/ad3c4311gy1glno9oewpuj20c302n0t0.jpg" alt="img"></p>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>去银行办理业务c，a窗口办理不了，需要去b窗口</p>
<p><img src= "/img/loading.gif" data-src="http://ww1.sinaimg.cn/large/ad3c4311gy1glno5xnxy5j206y03cjrh.jpg" alt="img"> </p>
<p>浏览器发送一个请求：<a href="http://127.0.0.1:8080/demo2/demo" target="_blank" rel="noopener">http://127.0.0.1:8080/web02/demo</a></p>
<p>服务器响应浏览器这个请求，返回给浏览器一个新的地址：<a href="http://127.0.0.1:8080/web02/demo2" target="_blank" rel="noopener">http://127.0.0.1:8080/web02/demo2</a></p>
<p>浏览器再发送新的这个请求给服务器：<a href="http://127.0.0.1:8080/web02/demo2" target="_blank" rel="noopener">http://127.0.0.1:8080/web02/demo2</a></p>
<h1 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h1><p>（1）使用@WebServlet注解 ，替代xml文件</p>
<p><img src= "/img/loading.gif" data-src="file:////tmp/wps-lyh/ksohtml/wpspFYcR4.jpg" alt="img"> </p>
<p>@WebServlet(“/anno”)—首次访问该servlet的时候初始化</p>
<p>@WebServlet(value = “/anno”,loadOnStartup = 0) 随着容器的启动而启动（任意数字都可以）</p>
<p>（2）引入json类库</p>
<p>引入fastjson</p>
<p>response.getWriter().println(JSON.toJSONString(list));</p>
<p><a href="http://localhost:8080/web03/list，这个地址相当于一个api了" target="_blank" rel="noopener">http://localhost:8080/web03/list，这个地址相当于一个api了</a></p>
<h1 id="网页异步刷新技术Ajax"><a href="#网页异步刷新技术Ajax" class="headerlink" title="网页异步刷新技术Ajax"></a>网页异步刷新技术Ajax</h1><p>（1）ajax</p>
<p>同步请求技术：刷新网页的时候，又向服务器发送一次请求，原来网页的内容就丢失了，http是无状态的，不保存上次的数据。</p>
<p>网页异步刷新技术Ajax：在不刷新网页的情况下，更新网页数据。主要包括以下步骤：</p>
<ol>
<li>请求网页</li>
<li>请求数据</li>
<li>将请求的数据渲染到表格中（客户端渲染技术）</li>
</ol>
<p>（2）jquery中ajax方法请求数据</p>
<ol>
<li>引入jquery库 <a href="https://www.bootcdn.cn/jquery/1.12.4/" target="_blank" rel="noopener">https://www.bootcdn.cn/jquery/1.12.4/</a></li>
<li>Ajax相关的方法</li>
<li>jquery操作请求成功后的数据</li>
</ol>
<p>（3）解决用户跨域访问问题</p>
<p>协议、域名、端口号，三个中有一个不一致的两个系统之间使用ajax请求，存在跨域问题。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>,<span class="string">"http://192.168.166.1:8080"</span>);</span><br></pre></td></tr></table></figure>

<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>（1）servletcontext</p>
<p>ServletContext对象有web容器在启动项目时创建，该对象可用于从web.xml文件获取配置信息。每个web应用程序只有一个ServletContext对象。</p>
<ul>
<li>在Servlet init方法中获取ServletContext</li>
<li>通过Request对象获取ServletContext对象</li>
</ul>
<p>（2） servletconfig对象</p>
<p>（3） lombok的使用</p>
<ol>
<li><p>在工程中引入lombok，通过注解实现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Idea安装lombok插件</p>
</li>
<li><p>Lombok的使用</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Getter</span></span><br><span class="line"><span class="comment">//@Setter</span></span><br><span class="line"><span class="comment">//@ToString</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String passwd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="jsp介绍"><a href="#jsp介绍" class="headerlink" title="jsp介绍"></a>jsp介绍</h1><p>（1）</p>
<p>动态网页技术  Jsp/asp/asp.net php –》html –》浏览器解析并展示</p>
<p>编程阶段：html，css，javascript，相关后台脚本 –》转化成静态html</p>
<p>（2）jsp的执行原理</p>
<p>index.jsp–&gt;index_jsp.java（Sevlet容器帮助我们做出来的）–&gt;编译–&gt;index_jsp.class–&gt;加载到虚拟机运行</p>
<p>（3）jsp生命周期</p>
<p>（4）jsp常用指令</p>
<p>JSP中有三种类型的指令标签：</p>
<p>&lt;%@page …%&gt; 定义页面相关属性，如脚本语言，错误页面和缓冲技术。</p>
<p>&lt;%@include …%&gt; 在编译阶段包括文件。</p>
<p>include指令和include的标签的区别</p>
<p>&lt;%@include file=”2.jsp”%&gt;  include标签，先合并在编译，生成一个class</p>
<p>&lt;jsp:include page=”2.jsp”&gt;  include指令，先各自编译，再合并内容，生成多个class</p>
<p>ubuntu idea编译jsp后的.java和.class文件在./.cache/JetBrains/IntelliJIdea2020.1/tomcat/</p>
<p>&lt;%@taglib …%&gt; 声明页面中使用的包含自定义操作的标签库。 </p>
<p>（5）内置对象，request，session，application的作用域</p>
<p>page，request，session，application的生命周期，递增</p>
<ul>
<li>page：对当前页面有效</li>
<li>request：对一次请求有效，HttpServletRequest<ul>
<li>处理客户一次请求的数据。如果要传递到下次请求，使用请求转发</li>
<li>用户打开浏览器第一次访问系统的资源，一次会话活动开始。用户关闭浏览器，会话结束。</li>
</ul>
</li>
<li>session：对一次会话有效，HttpSession<ul>
<li>存储用户的登录信息</li>
</ul>
</li>
<li>application：对一个应用有效 ServletContent<ul>
<li>可以做网站流量统计</li>
</ul>
</li>
</ul>
<p>（6）JSTL标签</p>
<p>（7）EL表达式</p>
<p>JSP表达式语言（EL）使得可以轻松访问应用程序数据。</p>
<p>JSP EL允许用来创建算术和逻辑表达式。</p>
<p>EL隐式对象</p>
<ul>
<li>pageScope：page作用域</li>
<li>requestScope：request作用域</li>
<li>sessionScope：session作用域</li>
<li>applicationScope：application作用域</li>
<li>cookie：Cookie值（会话部分讲）</li>
<li>pageContent：pageContent对象</li>
</ul>
<p>pageScope、requestScope、sessionScope和applicationScope变量提供对存储在每个范围级别的变量的访问。如果需要显式访问应用程序范围中的变量，则可以通过application变量applicationScope来访问。</p>
<h1 id="会话技术–cookie工作原理"><a href="#会话技术–cookie工作原理" class="headerlink" title="会话技术–cookie工作原理"></a>会话技术–cookie工作原理</h1><p>会话跟踪是跟踪用户状态的一种技术。http协议是无状态的，需要使用会话跟踪技术来维护用户状态。</p>
<p>（1）向浏览器写入cookie以及设置cookie有效期</p>
<p>（2）设置cookie的demian和path</p>
<p>cookie.setPath(String path)</p>
<p>在访问子路径时，会包含其父路径的Cookie，而在访问父路径时，不包含子路径的Cookie。</p>
<ul>
<li>设置js脚本禁止访问cookie</li>
<li>获取cookie、删除cookie</li>
<li>httpsession介绍</li>
<li>httpsession属性获取、设置、删除</li>
<li>httpsession的生命周期</li>
</ul>
<p>（3）JSTL标签</p>
<ul>
<li>核心标签</li>
<li>格式化标签</li>
<li>函数标签</li>
<li>导入jstl相关jar包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jstl&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>在jsp页面导入</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br></pre></td></tr></table></figure>

<p>（4）JSTL标签–forEach标签</p>
<p>（5）其他标签</p>
<p>（6）格式化标签</p>
<p>1、在jsp中加入</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"fmt"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/fmt"</span> %&gt;</span><br></pre></td></tr></table></figure>

<p>2、日期格式化</p>
<p>3、数字格式化</p>
<p>（7）函数标签</p>
<p>1、在jsp文件中加入</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"fn"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/functions"</span> %&gt;</span><br></pre></td></tr></table></figure>

<h1 id="案例实战"><a href="#案例实战" class="headerlink" title="案例实战"></a>案例实战</h1><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><h2 id="跳转到登录界面"><a href="#跳转到登录界面" class="headerlink" title="跳转到登录界面"></a>跳转到登录界面</h2><ul>
<li>客户端不能访问任何jsp</li>
<li>隐藏jsp，放到WEB-INF下，不能通过浏览器直接访问</li>
<li>服务器内部转发是可以访问的</li>
<li>所有的业务请求都到，一个单独的类中完成</li>
<li>所有请求请求到servlet</li>
</ul>
<h2 id="展示部门列表数据"><a href="#展示部门列表数据" class="headerlink" title="展示部门列表数据"></a>展示部门列表数据</h2><ul>
<li>重定向之前得request.getContextPath()拿到上下文路径</li>
<li>为了美观简单，doGet方法一并放到doPost处理</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">	doPost(request,response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="为系统增加登录认证"><a href="#为系统增加登录认证" class="headerlink" title="为系统增加登录认证"></a>为系统增加登录认证</h2><p>主页：如果已经登录，展示主页信息，否则跳转到登录页面。</p>
<h2 id="新增部门列表"><a href="#新增部门列表" class="headerlink" title="新增部门列表"></a>新增部门列表</h2><h2 id="修改部门"><a href="#修改部门" class="headerlink" title="修改部门"></a>修改部门</h2><h2 id="保存修改"><a href="#保存修改" class="headerlink" title="保存修改"></a>保存修改</h2><h2 id="数据结构微调—uuid"><a href="#数据结构微调—uuid" class="headerlink" title="数据结构微调—uuid"></a>数据结构微调—uuid</h2><h2 id="保存部门"><a href="#保存部门" class="headerlink" title="保存部门"></a>保存部门</h2><h2 id="删除部门"><a href="#删除部门" class="headerlink" title="删除部门"></a>删除部门</h2><p>1、删除弹窗二次提示</p>
<h2 id="javaweb过滤器filter"><a href="#javaweb过滤器filter" class="headerlink" title="javaweb过滤器filter"></a>javaweb过滤器filter</h2><ul>
<li><p>filter是对客户端访问资源的过滤，符合条件放行，并且可以对目标资源访问前后进行逻辑处理。</p>
</li>
<li><p>编写一个过滤器，只要实现filter接口就行了</p>
</li>
<li><p>过滤器的生命周期：</p>
<ul>
<li>一个过滤器在系统启动后只创建一个对象</li>
<li>要让容器知道过滤器的存在，只需要将过滤器注册到容器中：xml配置方式和注解方式</li>
</ul>
</li>
<li><p>匹配规则</p>
<ul>
<li>完全匹配    /servlet</li>
<li>目录匹配    /abc/*</li>
<li>扩展名匹配    .jsp .html</li>
</ul>
</li>
</ul>
<h2 id="统一认证权限"><a href="#统一认证权限" class="headerlink" title="统一认证权限"></a>统一认证权限</h2><p>Servlet只能配置哪些uri需要走过滤器，不能配置哪些uri不走过滤器。</p>
<h2 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h2><ul>
<li>提取公共的东西方法到一个BaseServlet类中实现</li>
<li>约定优于配置</li>
</ul>
<h2 id="引入jquery类库"><a href="#引入jquery类库" class="headerlink" title="引入jquery类库"></a>引入jquery类库</h2><ul>
<li>用户名或密码错误后，在不刷新页面的情况下把提示信息显示出来</li>
<li>表单提交会刷新页面，ajax技术的核心，就是不刷新页面，还能向服务器请求</li>
</ul>
<h2 id="服务器响应客户端json数据"><a href="#服务器响应客户端json数据" class="headerlink" title="服务器响应客户端json数据"></a>服务器响应客户端json数据</h2><p>服务器响应ajax请求，响应的是数据，json/xml，text，但不能是超文本</p>
<h2 id="异步展示部门列表数据"><a href="#异步展示部门列表数据" class="headerlink" title="异步展示部门列表数据"></a>异步展示部门列表数据</h2><ul>
<li>同步请求：携带数据转发到jsp视图。</li>
<li>异步请求：<ul>
<li>先请求转发到jsp视图 /dept</li>
<li>在jsp视图中，再向服务器发一次ajax请求 /dept?opt=list</li>
<li>将ajax请求的数据渲染到jsp视图中</li>
</ul>
</li>
</ul>
<h1 id="JavaWeb三层架构详解"><a href="#JavaWeb三层架构详解" class="headerlink" title="JavaWeb三层架构详解"></a>JavaWeb三层架构详解</h1><h2 id="什么是三层架构？"><a href="#什么是三层架构？" class="headerlink" title="什么是三层架构？"></a>什么是三层架构？</h2><p>​    <a href="https://baike.baidu.com/item/三层架构/11031448" target="_blank" rel="noopener">三层架构</a>(3-tier architecture) 通常意义上的三层架构就是将整个业务应用划分为：界面层（User Interface layer）、业务逻辑层（Business Logic Layer）、数据访问层（Data access layer）。区分层次的目的即为了“<a href="https://baike.baidu.com/item/高内聚低耦合/5227009" target="_blank" rel="noopener">高内聚低耦合</a>”的思想。在软件体系架构设计中，分层式结构是最常见，也是最重要的一种结构。微软推荐的分层式结构一般分为三层，从下至上分别为：数据访问层（又称为持久层）、业务逻辑层（又或称为领域层）、表示层。</p>
<h3 id="表示层（UI层）"><a href="#表示层（UI层）" class="headerlink" title="表示层（UI层）"></a>表示层（UI层）</h3><p>​    表示层也称为界面层，位于最外层（最上层），离用户最近。用于显示数据和接收用户输入的数据，为用户提供一种交互式操作的界面。</p>
<h3 id="业务逻辑层（BLL层）"><a href="#业务逻辑层（BLL层）" class="headerlink" title="业务逻辑层（BLL层）"></a>业务逻辑层（BLL层）</h3><p>​    负责关键业务的处理和数据的传递。复杂的逻辑判断和涉及到数据库的数据验证都需要在此做出处理。主要是针对具体的问题的操作，也可以理解成对数据层的操作，对数据业务逻辑处理，如果说数据层是积木，那逻辑层就是对这些积木的搭建。</p>
<h3 id="数据访问层（DAL层）"><a href="#数据访问层（DAL层）" class="headerlink" title="数据访问层（DAL层）"></a>数据访问层（DAL层）</h3><p>​    主要负责对数据库的直接访问，为业务逻辑层提供数据，根据传入的值来操作数据库，增、删、改、查。</p>
<h2 id="为什么要用三层架构呢？"><a href="#为什么要用三层架构呢？" class="headerlink" title="为什么要用三层架构呢？"></a>为什么要用三层架构呢？</h2><p><strong>1.团队开发，便于管理</strong></p>
<p>​    三层架构使得合作开发成为可能，由于各层相互独立，一个小组只需负责一小块就可以。结构化的编程方法面对大型的项目会感到力不从心，因为结构化设计必定会使程序变的错综复杂。逻辑主要在BLL层，就使得UI层也就是客户端不承担太多的职责，即使更新业务逻辑，也无需修改客户端，不用重新部署。 </p>
<p><strong>2.解耦</strong></p>
<p>​    上一层依赖于下一层，如果测试下一层没有问题，那么问题就只有可能发现在本层了，便于发现和改正BUG。体现了“高内聚，低耦合”的思想。比如楼房是分层的，我们要到哪一层楼非常方便，只需在电梯里按下那个楼层的层号即可。而三层架构就好比开发的软件“楼”，哪层出现Bug，哪层有问题，我们作为开发人员能够随时找到，并修正。 各个层次分工明确，将一个复杂问题简单拆分了。</p>
<p> <strong>3.代码的复用和劳动成本的减少</strong></p>
<p>​    分层的根本在于代码的复用和劳动成本的减少。分层的最理想化的结果是实现层与层之间的互不依赖的内部实现，所谓的即插即用！</p>
<p>当然啦，三层架构也是有一定的缺点，但是总的来说，利大于弊。</p>
<p>那么下面写一个小项目来具体地深入了解一下三层架构，项目目录如下:</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015204128802?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217204918777"></p>
<h3 id="表示层Model"><a href="#表示层Model" class="headerlink" title="表示层Model"></a>表示层Model</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Books</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Books [book_id="</span> + book_id + <span class="string">", book_name="</span> + book_name + <span class="string">", isbn="</span> + isbn + <span class="string">", author="</span> + author + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Books</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Books</span><span class="params">(<span class="keyword">int</span> book_id, String book_name, String isbn, String author)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.book_id = book_id;</span><br><span class="line">		<span class="keyword">this</span>.book_name = book_name;</span><br><span class="line">		<span class="keyword">this</span>.isbn = isbn;</span><br><span class="line">		<span class="keyword">this</span>.author = author;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> book_id;</span><br><span class="line">	<span class="keyword">private</span> String book_name;</span><br><span class="line">	<span class="keyword">private</span> String isbn;</span><br><span class="line">	<span class="keyword">private</span> String author;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBook_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> book_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBook_id</span><span class="params">(<span class="keyword">int</span> book_id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.book_id = book_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getBook_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> book_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBook_name</span><span class="params">(String book_name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.book_name = book_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getIsbn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> isbn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIsbn</span><span class="params">(String isbn)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.isbn = isbn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> author;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthor</span><span class="params">(String author)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.author = author;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="表示层Controller"><a href="#表示层Controller" class="headerlink" title="表示层Controller"></a>表示层Controller</h3><p>BooksServlet.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.entity.Books;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.service.BooksService;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.service.impl.BooksServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* Servlet implementation class Books</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/BooksServlet"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BooksServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">BooksService booksService = BooksServiceImpl.getInstance();</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@see</span> HttpServlet#HttpServlet()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BooksServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>();</span><br><span class="line"><span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@see</span> HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">response.getWriter().append(<span class="string">"Served at: "</span>).append(request.getContextPath());</span><br><span class="line">doPost(request, response);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@see</span> HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">String action = request.getParameter(<span class="string">"action"</span>);</span><br><span class="line">System.out.println(<span class="string">"action:"</span> + action);</span><br><span class="line"><span class="keyword">if</span> (action.equals(<span class="string">"add"</span>)) &#123;</span><br><span class="line">doAddBooks(request, response);</span><br><span class="line">response.sendRedirect(<span class="string">"index.jsp"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (action.equals(<span class="string">"select"</span>)) &#123;</span><br><span class="line">response.sendRedirect(request.getContextPath() + <span class="string">"/Books/selBooks.jsp"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (action.equals(<span class="string">"remove"</span>)) &#123;</span><br><span class="line">doDelBooks(request, response);</span><br><span class="line">response.sendRedirect(<span class="string">"SelBooksServlet"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doAddBooks</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">Books book = <span class="keyword">new</span> Books();</span><br><span class="line"><span class="comment">//book.setBook_id(Integer.parseInt(request.getParameter("book_id")));</span></span><br><span class="line">book.setBook_name(request.getParameter(<span class="string">"book_name"</span>));</span><br><span class="line">book.setIsbn(request.getParameter(<span class="string">"isbn"</span>));</span><br><span class="line">book.setAuthor(request.getParameter(<span class="string">"author"</span>));</span><br><span class="line"><span class="keyword">int</span> result = booksService.addBooks(book);</span><br><span class="line"><span class="keyword">if</span> (result &gt; <span class="number">0</span>)</span><br><span class="line">System.out.println(<span class="string">"添加book成功"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">System.out.println(<span class="string">"添加book失败"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doDelBooks</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line"><span class="keyword">int</span> result = booksService.delBooks(id);</span><br><span class="line"><span class="keyword">if</span> (result &gt; <span class="number">0</span>)</span><br><span class="line">System.out.println(<span class="string">"删除book成功"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">System.out.println(<span class="string">"删除book失败"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SelBooksServlet.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.entity.Books;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.service.BooksService;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.service.impl.BooksServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> * Servlet implementation class SelBooksServlet</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   <span class="meta">@WebServlet</span>(<span class="string">"/SelBooksServlet"</span>)</span><br><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SelBooksServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">   BooksService booksService = BooksServiceImpl.getInstance();</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@see</span> HttpServlet#HttpServlet()</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">SelBooksServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line">      <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@see</span> HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">      <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">      response.getWriter().append(<span class="string">"Served at: "</span>).append(request.getContextPath());</span><br><span class="line">      doPost(request, response);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@see</span> HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">static</span> String keyword = <span class="string">""</span>;</span><br><span class="line">      <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">      request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">      keyword = request.getParameter(<span class="string">"keyword"</span>);</span><br><span class="line">      System.out.println(<span class="string">"keyword:"</span> + keyword);</span><br><span class="line">      <span class="keyword">if</span> (keyword == <span class="string">""</span>)</span><br><span class="line">      	doSelAllBooks(request, response);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      	doSelBooks(request, response);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSelAllBooks</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">   	List&lt;Books&gt; list = booksService.selAllBooks();</span><br><span class="line">   	request.setAttribute(<span class="string">"books"</span>, list);</span><br><span class="line">   	System.out.println(<span class="string">"查询所有"</span>);</span><br><span class="line">   	RequestDispatcher view = request.getRequestDispatcher(<span class="string">"/Books/selResult.jsp"</span>);</span><br><span class="line">   	view.forward(request, response);</span><br><span class="line">   &#125;  </span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSelBooks</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">   	Books book = booksService.selBooks(keyword);</span><br><span class="line">   	List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">   	list.add(book);</span><br><span class="line">   	request.setAttribute(<span class="string">"books"</span>, list);</span><br><span class="line">   	System.out.println(<span class="string">"条件查询"</span>);</span><br><span class="line">   	RequestDispatcher view = request.getRequestDispatcher(<span class="string">"/Books/selResult.jsp"</span>);</span><br><span class="line">   	view.forward(request, response);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="表示层View"><a href="#表示层View" class="headerlink" title="表示层View"></a>表示层View</h3><p>index.jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;a href="Books/addBooks.jsp"&gt;添加&lt;/a&gt;</span><br><span class="line">&lt;a href="BooksServlet?action=select"&gt;查询&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>addBooks.jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/book/BooksServlet?action=add"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;table border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span> cellpadding=<span class="string">"0"</span> style=<span class="string">"align:center;"</span>&gt;</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;图书名称:&lt;/td&gt;&lt;td&gt;&lt;input type="text" name="book_name"&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;国际标准书号:&lt;/td&gt;&lt;td&gt;&lt;input type="text" name="isbn"&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;作者:&lt;/td&gt;&lt;td&gt;&lt;input type="text" name="author"&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;&lt;input type="submit" value="提交"&gt;&lt;/td&gt;&lt;td&gt;&lt;input type="button" value="返回"&gt;&lt;/td&gt;</span><br><span class="line"> 	&lt;/tr&gt;</span><br><span class="line"> &lt;/table&gt;</span><br><span class="line"> &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>selBooks.jsp</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/book/SelBooksServlet"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"keyword"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"查询"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>selResult.jsp</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">import</span>=<span class="string">"com.gpnu.book.entity.Books,java.util.List"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"Books/addBooks.jsp"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span> <span class="attr">cellspacing</span>=<span class="string">"0"</span> <span class="attr">cellpadding</span>=<span class="string">"0"</span> <span class="attr">style</span>=<span class="string">"align:center;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">bgcolor</span>=<span class="string">"ff9900"</span> <span class="attr">style</span>=<span class="string">"font-weight:bold;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>图书编号<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>图书名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>国际标准号<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>作者<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line">	List&lt;Books&gt; book = (List)request.getAttribute("books");</span><br><span class="line">	if(book.size()!=0)&#123;</span><br><span class="line">    	for(int i=0;i<span class="tag">&lt;<span class="name">book.size();i++)</span> &#123;</span></span><br><span class="line"><span class="tag">       		<span class="attr">pageContext.setAttribute</span>("<span class="attr">book</span>",<span class="attr">book.get</span>(<span class="attr">i</span>)); </span></span><br><span class="line"><span class="tag">%&gt;</span>  </span><br><span class="line">	<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;book.book_id &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span>    </span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;book.book_name &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;book.isbn &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;book.author &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>|<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"BooksServlet?action=remove&amp;id=$&#123;book.book_id &#125;"</span> <span class="attr">onclick</span>=<span class="string">'return confirm("确定要删除吗?")'</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">      &#125;</span></span><br><span class="line"><span class="tag">    &#125;<span class="attr">else</span>&#123;</span></span><br><span class="line"><span class="tag">     %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"6"</span>&gt;</span>数据库中没有数据！<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag">    %&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="持久层接口"><a href="#持久层接口" class="headerlink" title="持久层接口"></a>持久层接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.dao;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.entity.Books;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BooksDao</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;Books&gt; <span class="title">selAllBooks</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function">Books <span class="title">selBooks</span><span class="params">(String keyword)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">addBooks</span><span class="params">(Books book)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">delBooks</span><span class="params">(<span class="keyword">int</span> book_id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">booksCount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="持久层实现类"><a href="#持久层实现类" class="headerlink" title="持久层实现类"></a>持久层实现类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.dao.BooksDao;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.entity.Books;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.common.DBUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BooksDaoImpl</span> <span class="keyword">implements</span> <span class="title">BooksDao</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> Connection conn;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BooksDaoImpl</span><span class="params">(Connection conn)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.conn = conn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Books&gt; <span class="title">selAllBooks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">	PreparedStatement pstam = <span class="keyword">null</span>;</span><br><span class="line">	ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">	Books book = <span class="keyword">null</span>;		<span class="keyword">try</span> &#123;</span><br><span class="line">		pstam = conn.prepareStatement(<span class="string">"select * from tbl_book"</span>);</span><br><span class="line">		rs = pstam.executeQuery();</span><br><span class="line">		<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">			book = <span class="keyword">new</span> Books();</span><br><span class="line">			book.setBook_id(rs.getInt(<span class="string">"book_id"</span>));</span><br><span class="line">			book.setBook_name(rs.getString(<span class="string">"book_name"</span>));</span><br><span class="line">			book.setIsbn(rs.getString(<span class="string">"isbn"</span>));</span><br><span class="line">			book.setAuthor(rs.getString(<span class="string">"author"</span>));</span><br><span class="line">			list.add(book);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"在查询全部book的时候出错了.错误信息是 ："</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeStatement(rs, pstam);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">booksCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Books <span class="title">selBooks</span><span class="params">(String keyword)</span> </span>&#123;</span><br><span class="line">	Books book = <span class="keyword">new</span> Books();</span><br><span class="line">	PreparedStatement pStatement = <span class="keyword">null</span>;</span><br><span class="line">	ResultSet rSet = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		pStatement = conn.prepareStatement(<span class="string">"select * from tbl_book where book_name like ?"</span>);</span><br><span class="line">		pStatement.setString(<span class="number">1</span>, <span class="string">"%"</span> + keyword + <span class="string">"%"</span>);</span><br><span class="line">		rSet = pStatement.executeQuery();</span><br><span class="line">		<span class="keyword">if</span> (rSet.next()) &#123;</span><br><span class="line">			book.setBook_id(rSet.getInt(<span class="string">"book_id"</span>));</span><br><span class="line">			book.setBook_name(rSet.getString(<span class="string">"book_name"</span>));	</span><br><span class="line">			book.setIsbn(rSet.getString(<span class="string">"isbn"</span>));</span><br><span class="line">			book.setAuthor(rSet.getString(<span class="string">"author"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeStatement(rSet, pStatement);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addBooks</span><span class="params">(Books book)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">	PreparedStatement pstam = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		pstam = conn.prepareStatement(<span class="string">"insert into tbl_book(book_name,isbn,author) values(?,?,?)"</span>);</span><br><span class="line">		<span class="comment">//pstam.setInt(1, book.getBook_id());</span></span><br><span class="line">		pstam.setString(<span class="number">1</span>, book.getBook_name());</span><br><span class="line">		pstam.setString(<span class="number">2</span>, book.getIsbn());</span><br><span class="line">		pstam.setString(<span class="number">3</span>, book.getAuthor());</span><br><span class="line">		result = pstam.executeUpdate();</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"添加book出错.错误信息是 ："</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeStatement(<span class="keyword">null</span>, pstam);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delBooks</span><span class="params">(<span class="keyword">int</span> book_id)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">	PreparedStatement pstam = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		pstam = conn.prepareStatement(<span class="string">"DELETE FROM tbl_book WHERE book_id =?"</span>);</span><br><span class="line">		pstam.setInt(<span class="number">1</span>, book_id);</span><br><span class="line">		result = pstam.executeUpdate();</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"删除book出错.错误信息是 ："</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeStatement(<span class="keyword">null</span>, pstam);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="业务逻辑层接口"><a href="#业务逻辑层接口" class="headerlink" title="业务逻辑层接口"></a>业务逻辑层接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.service;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.entity.Books;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BooksService</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;Books&gt; <span class="title">selAllBooks</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function">Books <span class="title">selBooks</span><span class="params">(String keyword)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">addBooks</span><span class="params">(Books book)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">delBooks</span><span class="params">(<span class="keyword">int</span> book_id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="业务逻辑层实现类"><a href="#业务逻辑层实现类" class="headerlink" title="业务逻辑层实现类"></a>业务逻辑层实现类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gpnu.book.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.entity.Books;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.service.BooksService;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.common.DBUtils;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.dao.BooksDao;</span><br><span class="line"><span class="keyword">import</span> com.gpnu.book.dao.impl.BooksDaoImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BooksServiceImpl</span> <span class="keyword">implements</span> <span class="title">BooksService</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> BooksService instance = <span class="keyword">new</span> BooksServiceImpl();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BooksService <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Books&gt; <span class="title">selAllBooks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Connection conn = <span class="keyword">null</span>;</span><br><span class="line">	List list = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		conn = DBUtils.getConnection();</span><br><span class="line">		DBUtils.beginTransaction(conn);</span><br><span class="line">		BooksDao booksDao = <span class="keyword">new</span> BooksDaoImpl(conn);</span><br><span class="line">		list = booksDao.selAllBooks();</span><br><span class="line">		DBUtils.commit(conn);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"查询所有books错误"</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeConnection(conn);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Books <span class="title">selBooks</span><span class="params">(String keyword)</span> </span>&#123;</span><br><span class="line">	Connection conn = <span class="keyword">null</span>;</span><br><span class="line">	Books book = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		conn = DBUtils.getConnection();</span><br><span class="line">		DBUtils.beginTransaction(conn);</span><br><span class="line">		BooksDao booksDao = <span class="keyword">new</span> BooksDaoImpl(conn);</span><br><span class="line">		book = booksDao.selBooks(keyword);</span><br><span class="line">		DBUtils.commit(conn);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"条件查询books错误"</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeConnection(conn);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> book;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addBooks</span><span class="params">(Books book)</span> </span>&#123;</span><br><span class="line">	Connection conn = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		conn = DBUtils.getConnection();</span><br><span class="line">		DBUtils.beginTransaction(conn);</span><br><span class="line">		BooksDao booksDao = <span class="keyword">new</span> BooksDaoImpl(conn);</span><br><span class="line">		result = booksDao.addBooks(book);</span><br><span class="line">		DBUtils.commit(conn);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"增加books错误"</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeConnection(conn);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delBooks</span><span class="params">(<span class="keyword">int</span> book_id)</span> </span>&#123;</span><br><span class="line">	Connection conn = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		conn = DBUtils.getConnection();</span><br><span class="line">		DBUtils.beginTransaction(conn);</span><br><span class="line">		BooksDao booksDao = <span class="keyword">new</span> BooksDaoImpl(conn);</span><br><span class="line">		result = booksDao.delBooks(book_id);</span><br><span class="line">		DBUtils.commit(conn);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		System.out.println(<span class="string">"删除books错误"</span> + e.getMessage());</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;			DBUtils.closeConnection(conn);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们启动一下项目，我们作为用户直接看到的就是表示层的视图了</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750163?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
<p>而当我们点击查询，会跳转到查询的视图</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750167?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
<p>点击查询，我们会跳转到表示层的控制器，也就是Servlet，此时Servle会调用业务逻辑层的方法</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750217?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
<p>而业务逻辑层则会调用持久层（DAO层）的方法</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750252?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
<p>最后持久层连接到数据库，读取数据库的数据，保存为一个Model类</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750317?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
<p>将结果原路返回给表示层的视图View</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750330?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
<p>整个运行过程可以浓缩为一张图</p>
<p><img src= "/img/loading.gif" data-src="https://img-blog.csdn.net/20181015210750518?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NDk2NTQwNjU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="image-20201217212542314"></p>
</div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/09/07/java%E9%AB%98%E7%BA%A7/"><img class="prev-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">java高级</div></div></a></div><div class="next-post pull-right"><a href="/2021/09/07/Hexo_posts/"><img class="next-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hexo发帖</div></div></a></div></nav></article></main><footer id="footer" style="background-image: url(https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By dabing693</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">繁</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/js/hideMobileSidebar.js"></script></body></html>